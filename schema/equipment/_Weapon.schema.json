{
  "$schema": "http://json-schema.org/draft-07/schema",
  "$id": "/equipment/_Weapon.schema.json",
  "definitions": {
    "StructurePoints": {
      "title": "Structure Points",
      "description": "The structure points of the item. Use an array if the item consists of\nmultiple components that have individual structure points.",
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "points": {
            "description": "The structure points.",
            "type": "integer",
            "minimum": 1
          }
        },
        "required": [
          "points"
        ],
        "additionalProperties": false
      },
      "minItems": 1
    },
    "SanctifiedBy": {
      "description": "If the weapon is sanctified by a god and thus restricted to it's Blessed\nOnes.",
      "type": "object",
      "properties": {
        "id": {
          "description": "The tradition's identifier.",
          "type": "integer",
          "minimum": 1
        }
      },
      "required": [
        "id"
      ],
      "additionalProperties": false
    },
    "RestrictedToCultures": {
      "description": "Define if during character creation this weapon can only be bought by\ncharacters of a specific race or culture.",
      "oneOf": [
        {
          "type": "object",
          "properties": {
            "tag": {
              "const": "CulturesOfRace"
            },
            "id": {
              "description": "The race's identifier.",
              "type": "integer",
              "minimum": 1
            }
          },
          "required": [
            "tag",
            "id"
          ],
          "additionalProperties": false
        },
        {
          "type": "object",
          "properties": {
            "tag": {
              "const": "Culture"
            },
            "id": {
              "description": "The culture's identifier.",
              "type": "integer",
              "minimum": 1
            }
          },
          "required": [
            "tag",
            "id"
          ],
          "additionalProperties": false
        },
        {
          "type": "object",
          "properties": {
            "tag": {
              "const": "Cultures"
            },
            "list": {
              "description": "The cultures' identifiers.",
              "type": "object",
              "properties": {
                "id": {
                  "description": "The culture's identifier.",
                  "type": "integer",
                  "minimum": 1
                }
              },
              "required": [
                "id"
              ],
              "additionalProperties": false
            }
          },
          "required": [
            "tag",
            "list"
          ],
          "additionalProperties": false
        }
      ]
    },
    "PrimaryAttributeDamageThreshold": {
      "description": "The primary attribute damage and threshold value. You can either use an\ninteger, an object or a pair. Use an integer if you just have to define a\nsingle threshold value for the default primary attribute of the combat\ntechnique. Use an object if you need to define the value only or if you need\nto define the value as well as a single different primary attribute than\nwhich the combat technique uses. Use the pair if you need to set the primary\nattributes to AGI and STR (the combat technique has AGI but this item has\nAGI/STR) and/or if you need to set different thresholds for AGI and STR (e.g.\nAGI 14/STR 15). If the same values are in the pair, they will be merged (AGI\n14/STR 14 will be AGI/STR 14).",
      "oneOf": [
        {
          "type": "object",
          "properties": {
            "tag": {
              "const": "Single"
            },
            "attribute": {
              "description": "The primary attribute(s) if different from the default primary\nattribute(s) of the combat technique.",
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "id": {
                    "description": "The attribute's identifier.",
                    "type": "integer",
                    "minimum": 1
                  }
                },
                "required": [
                  "id"
                ],
                "additionalProperties": false
              },
              "minItems": 1,
              "uniqueItems": true
            },
            "threshold": {
              "description": "The attribute value representing the damage threshold.",
              "type": "integer",
              "minimum": 1
            }
          },
          "required": [
            "tag",
            "threshold"
          ],
          "additionalProperties": false
        },
        {
          "type": "object",
          "properties": {
            "tag": {
              "const": "Differing"
            },
            "list": {
              "description": "A list of primary attributes, each featuring a different threshold.",
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "attribute": {
                    "description": "The primary attribute.",
                    "type": "object",
                    "properties": {
                      "id": {
                        "description": "The attribute's identifier.",
                        "type": "integer",
                        "minimum": 1
                      }
                    },
                    "required": [
                      "id"
                    ],
                    "additionalProperties": false
                  },
                  "threshold": {
                    "description": "The attribute value representing the damage threshold.",
                    "type": "integer",
                    "minimum": 1
                  }
                },
                "required": [
                  "attribute",
                  "threshold"
                ],
                "additionalProperties": false
              },
              "minItems": 2,
              "uniqueItems": true
            }
          },
          "required": [
            "tag",
            "list"
          ],
          "additionalProperties": false
        }
      ]
    },
    "DamageMelee": {
      "description": "The damage of a weapon consists of a random part using dice and an optional\nflat part.",
      "type": "object",
      "properties": {
        "dice": {
          "description": "How many dice of which type are rolled to get the damage.",
          "$ref": "#/definitions/Dice"
        },
        "flat": {
          "description": "Flat damage, if any. It gets added to the result of the dice rolls.",
          "type": "integer"
        }
      },
      "required": [
        "dice"
      ],
      "additionalProperties": false
    },
    "DamageRanged": {
      "description": "The damage of a ranged weapon. It consists of a random part using dice and an\noptional flat part ny default. Some ranged weapons may work different so that\ndamage is either not applicable at all or it is outlined as *Special* and\nfurther defined in a description.",
      "oneOf": [
        {
          "type": "object",
          "properties": {
            "tag": {
              "const": "Default"
            },
            "dice": {
              "description": "How many dice of which type are rolled to get the damage.",
              "$ref": "#/definitions/Dice"
            },
            "flat": {
              "description": "Flat damage, if any. It gets added to the result of the dice rolls.",
              "type": "integer"
            }
          },
          "required": [
            "tag",
            "dice"
          ],
          "additionalProperties": false
        },
        {
          "type": "object",
          "properties": {
            "tag": {
              "const": "NotApplicable"
            }
          },
          "required": [
            "tag"
          ],
          "additionalProperties": false
        },
        {
          "type": "object",
          "properties": {
            "tag": {
              "const": "Special"
            }
          },
          "required": [
            "tag"
          ],
          "additionalProperties": false
        }
      ]
    },
    "Attack": {
      "description": "The AT modifier.",
      "type": "integer"
    },
    "Parry": {
      "description": "The PA modifier.",
      "type": "integer"
    },
    "Reach": {
      "description": "The reach of the weapon.",
      "type": "integer",
      "maximum": 4,
      "minimum": 1
    },
    "Length": {
      "description": "The length of the weapon in cm/halffingers.",
      "type": "integer",
      "minimum": 1
    },
    "ShieldSize": {
      "oneOf": [
        {
          "type": "object",
          "properties": {
            "tag": {
              "const": "Large"
            },
            "attack_penalty": {
              "description": "The attack penalty from the shield.",
              "type": "integer"
            }
          },
          "required": [
            "tag"
          ],
          "additionalProperties": false
        },
        {
          "type": "object",
          "properties": {
            "tag": {
              "const": "Medium"
            }
          },
          "required": [
            "tag"
          ],
          "additionalProperties": false
        },
        {
          "type": "object",
          "properties": {
            "tag": {
              "const": "Small"
            }
          },
          "required": [
            "tag"
          ],
          "additionalProperties": false
        }
      ]
    },
    "MeleeWeapon": {
      "title": "Melee Weapon",
      "type": "object",
      "properties": {
        "tag": {
          "const": "Melee"
        },
        "combat_technique": {
          "description": "The combat techniques and dependent values.",
          "oneOf": [
            {
              "type": "object",
              "properties": {
                "tag": {
                  "const": "ChainWeapons"
                },
                "damage_threshold": {
                  "$ref": "#/definitions/PrimaryAttributeDamageThreshold"
                },
                "at": {
                  "$ref": "#/definitions/Attack"
                },
                "reach": {
                  "$ref": "#/definitions/Reach"
                },
                "length": {
                  "$ref": "#/definitions/Length"
                }
              },
              "required": [
                "tag",
                "damage_threshold",
                "at",
                "reach",
                "length"
              ],
              "additionalProperties": false
            },
            {
              "type": "object",
              "properties": {
                "tag": {
                  "const": "Whips"
                },
                "damage_threshold": {
                  "$ref": "#/definitions/PrimaryAttributeDamageThreshold"
                },
                "at": {
                  "$ref": "#/definitions/Attack"
                },
                "reach": {
                  "$ref": "#/definitions/Reach"
                },
                "length": {
                  "$ref": "#/definitions/Length"
                }
              },
              "required": [
                "tag",
                "damage_threshold",
                "at",
                "reach",
                "length"
              ],
              "additionalProperties": false
            },
            {
              "type": "object",
              "properties": {
                "tag": {
                  "const": "Lances"
                },
                "at": {
                  "$ref": "#/definitions/Attack"
                },
                "length": {
                  "$ref": "#/definitions/Length"
                }
              },
              "required": [
                "tag",
                "at",
                "length"
              ],
              "additionalProperties": false
            },
            {
              "type": "object",
              "properties": {
                "tag": {
                  "const": "Shields"
                },
                "size": {
                  "$ref": "#/definitions/ShieldSize"
                },
                "damage_threshold": {
                  "$ref": "#/definitions/PrimaryAttributeDamageThreshold"
                },
                "at": {
                  "$ref": "#/definitions/Attack"
                },
                "pa": {
                  "$ref": "#/definitions/Parry"
                },
                "reach": {
                  "$ref": "#/definitions/Reach"
                }
              },
              "required": [
                "tag",
                "size",
                "damage_threshold",
                "at",
                "pa",
                "reach"
              ],
              "additionalProperties": false
            },
            {
              "type": "object",
              "properties": {
                "tag": {
                  "const": "Fans"
                },
                "size": {
                  "$ref": "#/definitions/ShieldSize"
                },
                "damage_threshold": {
                  "$ref": "#/definitions/PrimaryAttributeDamageThreshold"
                },
                "at": {
                  "$ref": "#/definitions/Attack"
                },
                "pa": {
                  "$ref": "#/definitions/Parry"
                },
                "reach": {
                  "$ref": "#/definitions/Reach"
                },
                "length": {
                  "$ref": "#/definitions/Length"
                }
              },
              "required": [
                "tag",
                "size",
                "damage_threshold",
                "at",
                "pa",
                "reach",
                "length"
              ],
              "additionalProperties": false
            },
            {
              "type": "object",
              "properties": {
                "tag": {
                  "const": "Default"
                },
                "id": {
                  "description": "The close combat technique's identifier.",
                  "type": "integer",
                  "minimum": 1
                },
                "damage_threshold": {
                  "$ref": "#/definitions/PrimaryAttributeDamageThreshold"
                },
                "at": {
                  "$ref": "#/definitions/Attack"
                },
                "pa": {
                  "$ref": "#/definitions/Parry"
                },
                "reach": {
                  "$ref": "#/definitions/Reach"
                },
                "length": {
                  "$ref": "#/definitions/Length"
                }
              },
              "required": [
                "tag",
                "id",
                "damage_threshold",
                "at",
                "pa",
                "reach",
                "length"
              ],
              "additionalProperties": false
            }
          ]
        },
        "damage": {
          "$ref": "#/definitions/DamageMelee"
        },
        "is_parrying_weapon": {
          "description": "Is the weapon a parrying weapon?",
          "type": "boolean"
        },
        "is_two_handed_weapon": {
          "description": "Is the weapon a two-handed weapon?",
          "type": "boolean"
        }
      },
      "required": [
        "tag",
        "combat_technique",
        "damage",
        "is_parrying_weapon",
        "is_two_handed_weapon"
      ],
      "additionalProperties": false
    },
    "RangedWeapon": {
      "title": "Ranged Weapon",
      "type": "object",
      "properties": {
        "tag": {
          "const": "Ranged"
        },
        "combat_technique": {
          "description": "The combat techniques and dependent values.",
          "oneOf": [
            {
              "type": "object",
              "properties": {
                "tag": {
                  "const": "ThrownWeapons"
                }
              },
              "required": [
                "tag"
              ],
              "additionalProperties": false
            },
            {
              "type": "object",
              "properties": {
                "tag": {
                  "const": "Default"
                },
                "ammunition": {
                  "description": "The needed ammunition.",
                  "type": "object",
                  "properties": {
                    "id": {
                      "description": "The item's identifier.",
                      "type": "integer",
                      "minimum": 1
                    }
                  },
                  "required": [
                    "id"
                  ],
                  "additionalProperties": false
                }
              },
              "required": [
                "tag",
                "ammunition"
              ],
              "additionalProperties": false
            }
          ]
        },
        "damage": {
          "$ref": "#/definitions/DamageRanged"
        },
        "range": {
          "description": "The range brackets for the weapon: close, medium, far. Distances in m.",
          "type": "object",
          "properties": {
            "close": {
              "description": "The close range bracket for the weapon. Distance in m.",
              "type": "integer",
              "minimum": 1
            },
            "medium": {
              "description": "The medium range bracket for the weapon. Distance in m.",
              "type": "integer",
              "minimum": 1
            },
            "far": {
              "description": "The far range bracket for the weapon. Distance in m.",
              "type": "integer",
              "minimum": 1
            }
          },
          "required": [
            "close",
            "medium",
            "far"
          ],
          "additionalProperties": false
        },
        "reload_time": {
          "description": "One or multiple reload times.",
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "value": {
                "description": "A reload time value in actions.",
                "type": "integer",
                "minimum": 1
              }
            },
            "required": [
              "value"
            ],
            "additionalProperties": false
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "length": {
          "$ref": "#/definitions/Length"
        }
      },
      "required": [
        "tag",
        "combat_technique",
        "damage",
        "range",
        "reload_time",
        "length"
      ],
      "additionalProperties": false
    }
  }
}
